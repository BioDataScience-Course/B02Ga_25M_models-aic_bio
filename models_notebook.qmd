---
title: "Relations entre morphologie et stratégies de nage chez les poissons des Grands Lacs"
author: "Amal Abarou, Ide Tchuileng, Christelle Baseka"
format:
  html:
    code-fold: true
    code-tools: true
    toc: true
editor: visual
lang: fr
bibliography: references.bib
---

<!--# Ceci est un commentaire. -->

<!--% Ceci est une consigne. Ne jamais modifier ni déplacer les consignes dans le document ! -->

<!--% Complétez le titre et le nom des auteurs (auteur1, auteur2, auteur3 et auteur 4) dans l'entête YAML.-->

## Introduction et but

<!--% Rédigez une courte introduction de 3 ou 5 phrases qui présente vos données. Ajoutez une phrase de but (que vous remanierez éventuellement en fonction des modèles que vous ajouterez plus tard). Vous pouvez citer la bibliographie en utilisant le formatage Markdown ad hoc et en incluant votre référence au format bibtex dans le fichier references.bib. -->

Les poissons des Grands Lacs présentent une grande diversité de morphologies et de comportements, qui influencent leur capacité à se déplacer dans leur environnement et à franchir des obstacles tels que barrages, passes à poissons ou variations de débit. Ces caractéristiques conditionnent leur performance de nage et leurs chances de migration et de survie.

Pour ce projet, les données de la **FishPass Sortable Attribute Database** [@benoit2023], regroupant des traits morphologiques (longueur maximale, forme du corps, taille et position des nageoires) et comportementaux (position verticale dans la colonne d'eau, comportement de banc) sont utilisées.

\
L’objectif est de mieux comprendre comment certains traits morphologiques influencent la position verticale dans la colonne d’eau et le comportement de banc. Pour cela, nous combinons des analyses descriptives, des graphiques et quelques modèles statistiques afin d’identifier les traits qui jouent un rôle clé dans les stratégies de déplacement des poissons.

## Matériel et méthodes

<!--% Indiquez ici d'où viennent les données et aussi quel logiciel (et version) vous utilisez pour les analyses. Inspirez-vous des projets du premier module de SDD II. -->

Les données utilisées proviennent de la base FishPass Morphology et de la base FishPass Behaviour compilées par [@benoit2023]. Les deux bases ont été fusionnées par espèce (Order, Family, Genus, Scientific.Name, Common.Name), ce qui a permis d’obtenir un jeu unique intégrant à la fois des mesures morphologiques et des informations comportementales pour chaque espèce. Pour ce projet, seules les variables morphologiques et comportementales les plus pertinentes ont été retenues : longueur maximale, profondeur du corps, rapport d’aspect, étroitesse du pédoncule caudal, position et taille des nageoires pectorales, position verticale et taille de l’œil, forme du corps et comportement de banc.

Les données ont été nettoyées et harmonisées : renommage des colonnes, conversion des variables numériques, suppression des lignes avec valeurs manquantes et ajout de labels et unités. Afin d’assurer une représentativité statistique suffisante, seuls les ordres présentant un effectif ≥ 10 individus ont été conservés. Les ordres retenus pour les analyses sont *Cypriniformes, Perciformes et Salmoniformes.* Les autres ordres, comportant trop peu d’observations, ont été exclus pour garantir la robustesse des résultats.

Les analyses sont réalisées dans `r R.version.string` avec le package `{tidyverse}` version `r packageVersion("tidyverse")` et `{tabularise}` version `r packageVersion("tabularise")` pour le traitement et la visualisation des données, et `{labelled}` version `r packageVersion("labelled")` pour les labels et unités. Le seuil de significativité α est fixé à 5 %.

## Analyses

```{r setup, include=FALSE}
# Ceci est nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))

# Configure Knitr to use AGG as graphic device
knitr::opts_chunk$set(dev = "ragg_png")

# Configuration de l'environnement
SciViews::R("model","infer", lang = "fr")
```

<!--% Importez les données que vous aurez préalablement nettoyées, remaniées et labélisées dans le script R nommé `R/import.R`. -->

```{r import}
# Lecture des données
Fish_data <- read.csv("data/Fish_data.csv", header = TRUE, sep = ",")
# Tableau des premières et dernières lignes
tabularise$headtail(Fish_data)
```

### Description des données

<!--% Chaque étudiant réalise et interprète un graphique pertinent en lien avec le but fixé et les modèles qui seront réalisés. Graphique et interprétation de l'étudiant #1 ci-dessous. -->

```{r chart1 }
# Relation entre rapport d’aspect et étroitesse du pédoncule caudal
chart(data = Fish_data,
      Etroitesse_pedoncule ~ Rapport_aspect %col=% Comportement_banc | Ordre) +
  geom_point(size = 3, alpha = 0.8) +
  labs(
    x = "Rapport d’aspect de la nageoire caudale",
    y = "Étroitesse du pédoncule caudal",
    title = "Relation entre la morphologie caudale et le comportement de banc",
    subtitle = "Comparaison du rapport d’aspect et de l’étroitesse du pédoncule caudal selon l’ordre"
  )
```

Le graphique illustre la relation entre le rapport d’aspect de la nageoire caudale et l’étroitesse du pédoncule caudal chez trois ordres de poissons (Cypriniformes, Perciformes et Salmoniformes), en distinguant les espèces grégaires (schooling) des espèces solitaires (non-schooling).

Globalement, on observe que les espèces grégaires(schooling) tendent à présenter des valeurs de rapport d’aspect plus élevées et un pédoncule caudal plus étroit que les espèces solitaires. Cette combinaison morphologique est typique d’une nage rapide, efficace et soutenue, adaptée aux déplacements collectifs dans la colonne d’eau. Elle favorise la réduction de la traînée hydrodynamique et une meilleure endurance, caractéristiques essentielles pour maintenir la cohésion d’un banc en mouvement.

Chez les Cypriniformes, cette tendance apparaît particulièrement nette : les espèces grégaires se concentrent dans une zone du graphique où le pédoncule est plus fin et le rapport d’aspect plus élevé.\
Chez les Perciformes, la dispersion est plus grande, ce qui suggère une diversité morphologique plus importante au sein du groupe, reflétant des stratégies de nage variées selon les espèces.\
Les Salmoniformes montrent un profil plus homogène, avec des morphologies globalement adaptées à la nage en pleine eau, indépendamment du comportement social, ce qui peut s’expliquer par leurs contraintes migratoires et leur mode de déplacement particulier.

Ce graphique met en évidence que les espèces présentant une morphologie caudale optimisée pour la vitesse et l’endurance c’est-à-dire un pédoncule étroit et un rapport d’aspect élevé sont majoritairement associées à un comportement grégaire. Ces résultats soutiennent l’hypothèse selon laquelle la morphologie influence la stratégie de déplacement, en particulier la capacité à se déplacer collectivement.

<!--% Graphique et interprétation de l'étudiant #2 ci-dessous. -->

```{r chart2}
#chart(data = Fish_data, Profondeur_corps ~ Taille_oeil %col=% Vertical_station | Ordre) +
chart(data = Fish_data, Taille_oeil ~ Vertical_station %fill=% Comportement_banc) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  geom_boxplot(width = 0.2, color = "black", alpha = 0.6, position = position_dodge(width = 0.9)) +
  geom_jitter(size = 1.8, width = 0.15, alpha = 0.6) +
  labs(
    title = "Variation de la taille de l’œil selon la position verticale et le comportement de banc",
    x = "Position dans la colonne d’eau",
    y = "Taille de l’œil (% HL)",
    fill = "Comportement de banc"
  )


```

Benthopelagic: Les espèces en groupe (bleu) ont généralement une médiane et un écart interquartile plus élevés que les espèces non-schooling (rouge). Et donc l'on peut dire que les poissons benthopelagic en groupe tendent a avoir des yeux proportionnellement plus grands,impliquant ainsi une dependance accrue a la vision dans ce comportement.

Demersal: La mediane des especes en grope(bleu) est egalement plus elevee que celle des especes non en groupe(rouge). La distribution en groupe est aussi plus compacte(moins de variabilite). Ici, le comportement en groupe est associe a des yeux plus grands, mais la distinction est moins nette que pour le groupe benthopelagic.

Pelagic: Les especes en groupe(bleu) presentent une mediane tres similaire a celle des solitaires(rouge), mais la distribution solitaire est beaucoup plus dispersee(le violon est tres large). Nous pouvons dire qu'ici la taille moyenne de l'oeil n'est pas un facteur discriminant entre le comportement en groupe chez les especes pelagiques. La grande dispersion du comportement solitaire pourrait etre due a desespeces tres profondes ou tres superficielles

<!--% Graphique et interprétation de l'étudiant #3 ci-dessous. -->

```{r chart3 }
chart(data = Fish_data,
      Taille_nageoire_pectorale ~ Comportement_banc %fill=% Forme_corps) +
  geom_boxplot(alpha = 1, width = 0.6, position = position_dodge(0.8)) +
  labs(
    x = "Comportement de banc",
    y = "Taille de la nageoire pectorale (mm)",
    title = "Taille des nageoires pectorales selon le comportement et la forme du corps") 
```

Les poissons solitaires (non-schooling) présentent en moyenne des nageoires pectorales plus grandes que ceux se déplaçant en groupe (schooling), surtout pour les individus à corps court et profond (Short/deep). Cette différence pourrait refléter une adaptation à la nage collective, où la manœuvrabilité individuelle est moins cruciale.

Chez les individus à corps court et profond, les nageoires sont particulièrement développées chez les poissons solitaires (médiane ≈ 0,26 mm), probablement pour compenser la morphologie et assurer la stabilité. Les poissons à corps allongé (Elongated) montrent une taille intermédiaire de nageoires, avec une forte variabilité chez les solitaires (médiane ≈ 0,18 mm), ce qui pourrait refléter des stratégies adaptées à différents habitats ou comportements. Enfin, les poissons fusiformes (Fusiform) possèdent les nageoires les plus petites et les plus constantes (≈ 0,17 mm), cohérentes avec une forme hydrodynamique favorisant la nage rapide sans nécessiter de grandes nageoires.

### Modélisation

Pour explorer les relations potentielles entre les différentes caractéristiques morphologiques des poissons étudiés, nous avons réalisé une analyse de corrélation de Pearson. Cette méthode permet d’évaluer la force et le sens de l’association linéaire entre deux variables quantitatives.

```{r corr}
(Fish_data_corr <- correlation(sselect(Fish_data,Longueur_max, Profondeur_corps, Rapport_aspect, Etroitesse_pedoncule, Position_nageoire_pectorale, Taille_nageoire_pectorale, Position_oeil_vertical, Taille_oeil))) |>
  tabularise()
```

La plupart des corrélations entre caractères sont faibles à modérées. Le rapport d’aspect et l’étroitesse du pédoncule caudal montrent une corrélation positive notable (r = 0,38), suggérant une adaptation à la nage rapide. La longueur maximale est fortement négativement corrélée avec la taille de l’œil (r = -0,69), tandis que la profondeur du corps est modérément liée à la taille des nageoires pectorales (r = 0,45).

<!--% Chaque modèle doit être décrit à l'aide d'un graphique et d'un tableau résumant le modèle. Les équations paramétrées de tous les modèles doivent être également présentes. L'analyse des résidus sera réalisée et interprétée pour chaque modèle. -->

#### Régression linéaire 1

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

```{r}
# Modèle de régression linéaire polynomial

#Poly1_lm <- lm(data = Fish_data, Longueur_max ~ Taille_oeil)

Poly1_lm <- lm(data = Fish_data, Longueur_max ~ Taille_oeil + I(Taille_oeil^2))
summary_(Poly1_lm) |> tabularise()
```

-Tous les coefficients sont statistiquement significatifs au seuil de 5%, ce qui signifie que la taille de l’œil et son carré ont un effet significatif sur la longueur maximale.

-Étendue des résidus : \[-95.43, 105.6\], les résidus sont très larges par rapport aux valeurs prédites, ce qui suggère des erreurs importantes pour certaines observations.

-Le modèle dans son ensemble est significatif et explique un peu plus de la moitié de la variation de la longueur maximale(R\^2 ajusté 54%), ce qui est correct mais laisse encore beaucoup de variabilité non expliquée.

```{r}
# Visualisation du modèle
chart(Poly1_lm)
```

```{r}
# Analyse des résidus
chart$residuals(Poly1_lm)
```

-   la distribution des résidus est très élevé par rapports aux valeurs prédites (A)
-   Les points suivent globalement la ligne,sauf pour les grandes valeurs qui s'écartent, donc la normalité est raisonnable.(B)
-   La tendance ascendante montre que la variance augmente avec la valeur prédite il y a hétéroscédasticité modérée.(C)
-   Présence des points influents avec une grande distance de Cook et un effet de levier.

#### Régression linéaire 2

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r}
Fish_data$log_Taille_oeil <- log(Fish_data$Taille_oeil)
Fish_rl2 <- lm(data = Fish_data,log_Taille_oeil ~ Longueur_max )
summary_(Fish_rl2) |> tabularise()
```

```{r}
#Visualisation du modele
chart(Fish_rl2)

```

```{r}
#Analyse des residus
chart$residuals(Fish_rl2)
```

Discussion:

Le modèle linéaire évaluant la relation entre la taille maximale du poisson (Longueur_max) et la taille relative de l’œil (log_Taille_oeil) révèle une relation négative hautement significative. Le coefficient associé à Longueur_max (β = –0,00466, p \< 2×10⁻¹⁶) indique que, chez les poissons des Grands Lacs, la taille de l’œil diminue proportionnellement lorsque la taille corporelle augmente. Autrement dit, les petites espèces présentent des yeux proportionnellement plus grands, tandis que les grandes espèces ont des yeux proportionnellement plus petits.

Ce résultat est cohérent avec des principes biologiques déjà établis : chez de nombreux poissons, la taille relative de l’œil est liée à la stratégie sensorielle, à la vision en milieux moins lumineux et à la pression sélective de la prédation. Les petites espèces dépendant davantage de la vision pour détecter les prédateurs ou rechercher la nourriture présentent souvent des yeux proportionnellement plus développés. À l’inverse, les grandes espèces peuvent compenser leur perception visuelle par d’autres sens, comme la ligne latérale, ou évoluer dans des environnements où une vision fine est moins déterminante.

Le modèle présente un R² de 0,525, indiquant que plus de la moitié de la variation de la taille relative de l’œil est expliquée par la taille corporelle. Pour un modèle basé sur un seul prédicteur morphologique, cette valeur est substantielle et montre que la taille corporelle est un déterminant majeur de la variation observée.

L’analyse des résidus montre que les hypothèses du modèle linéaire sont globalement respectées. Les résidus sont bien centrés autour de zéro et ne montrent pas de motif systématique majeur, ce qui confirme une relation appropriée entre les variables. Le QQ-plot montre une distribution des résidus proche de la normalité, avec seulement quelques valeurs extrêmes. On observe une légère hétéroscédasticité (variance des résidus un peu plus élevée pour les grandes longueurs), mais celle-ci reste faible et ne compromet pas la validité du modèle. Aucun point à fort levier n’indique une influence excessive sur les résultats.

#### Modèle linéaire 1

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

Examiner l’effet combiné de plusieurs traits morphologiques et comportementaux sur la longueur maximale.

```{r graphique lm1}

a <- chart(data = Fish_data, Longueur_max ~ Profondeur_corps %col=% Comportement_banc) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = TRUE) +
  labs(x = "Profondeur du corps", 
    y = "Longueur max (cm)") + 
 theme(
    legend.position = "bottom",
    legend.direction = "horizontal",
    legend.title = element_blank())

b <- chart(data = Fish_data, Longueur_max ~ Rapport_aspect %col=% Vertical_station) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = TRUE) + labs( x = "Rapport d'aspect",
  y = "Longueur max (cm)") + 
 theme(
    
legend.position = "bottom",
    legend.direction = "horizontal",
    legend.title = element_blank()) 

combine_charts(list(a,b))
```

Le graphique Profondeur_corps - Comportement_banc démontre une forte interaction entre la morphologie et le comportement sur la Longueur_max. Pour les espèces non-schooling, la Longueur_max est stable ou diminue légèrement lorsque la Profondeur_corps augmente (pente négative). En revanche, pour les espèces schooling (cyan), la Longueur_max augmente clairement et fortement lorsque la Profondeur_corps augmente (pente positive), ce qui suggère une allométrie positive chez ce groupe où les individus plus grands sont également plus profonds ou massifs.

Le graphique Vertical_station - Rapport_aspect montre que l'effet du Rapport_aspect sur la Longueur_max est inversé selon l'habitat. Chez les espèces benthopélagiques (saumon, près du fond), l'augmentation du Rapport_aspect (vitesse) est faiblement associée à une Longueur_max plus grande (pente légèrement positive). Au contraire, chez les espèces pélagiques (bleu, pleine eau), l'augmentation du Rapport_aspect est associée à une Longueur_max plus petite (pente clairement négative), ce qui justifie l'inclusion du terme d'interaction beta_4 dans votre modèle.

```{r}
#Fish_lm1A <- lm(data = Fish_data, Longueur_max ~ Taille_oeil + Profondeur_corps + Vertical_station + Profondeur_corps + Comportement_banc + Vertical_station + Rapport_aspect) 
#summary(Fish_lm1A) 

#Fish_lm1B <- lm(data = Fish_data, Longueur_max ~ Taille_oeil + Profondeur_corps + Vertical_station + Profondeur_corps * Comportement_banc + Vertical_station * Rapport_aspect) 
#summary(Fish_lm1B) 

#Fish_lm1C <- lm(data = Fish_data, subset = Vertical_station %in% c("pelagic", "benthopelagic"), Longueur_max ~ Taille_oeil + Profondeur_corps + Vertical_station + Profondeur_corps * Comportement_banc + Vertical_station * Rapport_aspect)  
#summary_(Fish_lm1C)

#Fish_lm1 <- lm(data = Fish_data,
#               subset = Vertical_station %in% c("pelagic", "benthopelagic"), Longueur_max ~ Taille_oeil + Vertical_station + Vertical_station * Rapport_aspect)
#summary_(Fish_lm1) |> tabularise()
```

Les premiers modèles présentent plusieurs limites. Le modèle initial sans interaction, bien que simple, n’explique que 51 % de la variance et ne retient qu’une seule variable significative, ce qui réduit sa pertinence biologique. L’ajout d’interactions dans le second modèle améliore légèrement l’ajustement (R² ajusté = 54 %), mais introduit une complexité importante sans gain substantiel, avec plusieurs termes non significatifs. Le troisième modèle, plus ciblé, atteint un meilleur R² (59 %), mais reste relativement complexe et inclut des variables dont l’effet est faible, et les résidus présentent une hétéroscédasticité. La **transformation logarithmique de Longueur_max** dans le quatrième modèle a permis de stabiliser la variance et de corriger les problèmes de résidus. Cette transformation a également rendu l’interaction non significative, conduisant à un modèle plus simple et robuste, ne conservant que les variables **Taille_oeil** et **Vertical_station**, avec un R² ajusté de 0,63.

```{r modele linéaire 1}
Fish_lm1 <- lm(data = Fish_data, 
               subset = Vertical_station %in% c("pelagic", "benthopelagic"), log(Longueur_max) ~ Taille_oeil + Vertical_station )  
summary_(Fish_lm1) |> tabularise()

Fish_sub <- subset(Fish_data,
                   Vertical_station %in% c("pelagic", "benthopelagic"))
chart(data = Fish_sub, log(Longueur_max) ~ Taille_oeil %col=% Vertical_station) +
  geom_point() +
  stat_smooth(method = "lm", formula = y ~ x)
```

```{r analyse residus lm1}
chart$residuals(Fish_lm1)
```

Le modèle montre que la taille relative de l’œil diminue significativement avec l’augmentation de la longueur maximale, traduisant un effet allométrique classique. Par ailleurs, les espèces pelagiques atteignent des tailles maximales plus élevées que les espèces non pelagiques. Le modèle explique une proportion importante de la variabilité observée (R² ajusté = 0,63). L’analyse des graphiques de résidus montre une distribution globalement centrée autour de zéro et une normalité satisfaisante, tandis que la variance apparaît relativement homogène, malgré la présence d’une légère structure non linéaire et de quelques observations à effet levier modéré. Dans l’ensemble, ces diagnostics indiquent que les hypothèses du modèle sont raisonnablement respectées et que les résultats peuvent être interprétés de manière fiable.

#### Modèle linéaire 2

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r}
Fish_lm2 <- lm(data = Fish_data, Taille_oeil ~ Longueur_max * Comportement_banc)
summary_(Fish_lm2) |> tabularise ()
```

-   le modèle est significatif dans son ensemble (R²ajusté = 0.4982), expliquant environ 50% de la variation de la taille d’œil.

-   Toutes les variables et l'interaction sont significatives (p \< 0.05), ce qui confirme la pertinence de l’effet combiné de la taille corporelle et du comportement de banc.

-   Les résidus sont raisonnables (étendue \[-13.56, 13.35\]), suggérant que le modèle est bien ajusté.

-   La taille de l’œil augmente avec la taille du corps, mais cet effet est plus marqué chez les poissons solitaires que chez ceux nageant en groupe, reflétant une moindre dépendance à la vision individuelle en banc.

```{r}
chart(data = Fish_data, Taille_oeil ~ Longueur_max   %col=% Comportement_banc) +
  geom_point() +
  stat_smooth(method = "lm", formula = y ~ x)
```

-Les poissons non-schooling ont une relation plus linéaire et moins raide. -Les poissons schooling montrent une pente plus prononcée, confirmant l’interaction trouvée dans le modèle (β3).

```{r}
# Analyse des résidus
chart$residuals(Fish_lm2)
```

-   L'etendue des residus est elevée par rapport aux valeurs prédites

-   Les résidus suivent à peu près une distribution normale

-   Il n' y a pas de tendance forte, homoscédasticité

-   Il y a présence d'observations influentes par leur distance de cook

-   Une observation a un effet de levier important avec une distance de cook influente

#### Modèle linéaire généralisé et/ou mixte 1

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

```{r essaie glm1}
#Fish_data$Forme_deep <- ifelse(Fish_data$Forme_corps == "short/deep", 1, 0)
#Fish_glm1 <- lme4::glmer(data = Fish_data, Forme_deep ~ Rapport_aspect + Etroitesse_pedoncule + Vertical_station + (1 | Ordre), family = binomial())
#summary(Fish_glm1)
```

Dans notre jeu de données, l’inclusion d’un effet aléatoire sur la variable Ordre n’est pas appropriée. En effet, ce facteur ne comporte que trois niveaux, ce qui est insuffisant pour estimer de manière fiable la variance d’un intercept aléatoire dans un modèle mixte. Les modèles à effets aléatoires requièrent un nombre de groupes nettement plus élevé afin d’obtenir une estimation stable et interprétable des paramètres. Dans notre cas, l’ajustement du modèle présente une non-convergence et une matrice Hessienne singulière, indiquant que les paramètres ne peuvent pas être déterminés de façon unique. Compte tenu de ces limitations méthodologiques, nous avons donc opté pour un modèle linéaire généralisé (GLM) classique, qui permet d’évaluer efficacement l’influence des variables explicatives sur la probabilité d’appartenir à la forme “short/deep”, sans dépendre d’un effet aléatoire impossible à estimer de manière fiable dans ce cas.

```{r}
#Fish_data$Forme_deep <- ifelse(Fish_data$Forme_corps == "short/deep", 1, ifelse(Fish_data$Forme_corps == "fusiforme", 0, NA))
#Fish_data2 <- subset(Fish_data, !is.na(Forme_deep))
#Fish_glm1 <- glm(data = Fish_data2, Forme_deep ~ Rapport_aspect + Etroitesse_pedoncule + Vertical_station, family = binomial(link = "logit"))
#Fish_glm1 <- glm(data = Fish_data2, Forme_deep ~ Rapport_aspect + Etroitesse_pedoncule + Vertical_station, family = quasibinomial)

Fish_data$Comportement_banc_bin <- ifelse(Fish_data$Comportement_banc == "schooling", 1, 0)

# Modèle logistique (GLM binaire)
Fish_glm1 <- glm(data = Fish_data, Comportement_banc_bin ~ Rapport_aspect + Position_oeil_vertical, family = binomial)
summary_(Fish_glm1) |> tabularise()
```

L'on a voulu d’abord comparer la forme “short/deep” avec “fusiforme” avec un modèle logistique, mais il y avait très peu de “short/deep” dans mon jeu de données. Ça donnait des messages d’erreur et des résultats impossibles à interpréter.

```{r}
#Visualisation du modèle
chart(data = Fish_data, Comportement_banc_bin ~ Rapport_aspect %col=% Position_oeil_vertical ) +
  geom_point(size = 3, alpha = 0.7) +
  scale_color_viridis_c() +
  geom_smooth(
    method = "glm",
    method.args = list(family = binomial),
    formula = y ~ x,
    se = TRUE,
    color = "green",
    linewidth = 1.2
  ) +
  labs(
    x = "Rapport d'aspect",
    y = "Comportement de banc (0 = non, 1 = oui)",
    color = "Position œil vertical",
    title = "Modèle logistique : effet du rapport d'aspect et de la position de l'œil"
  )

```

Discussion:

Le modèle logistique évaluant les déterminants morphologiques du comportement de banc montre que deux traits sont significativement associés à la probabilité qu’une espèce soit grégaire : le rapport d’aspect de la nageoire caudale et la position verticale de l’œil. Le coefficient positif du rapport d’aspect (β = 0,982, p = 0,036) indique que les espèces possédant une nageoire caudale plus effilée et plus haute ont une probabilité plus élevée de former des bancs. Ce résultat est cohérent avec la fonction hydrodynamique d’une caudale à fort rapport d’aspect, qui favorise une nage stable, économique et efficace dans des groupes denses.

À l’inverse, la position de l’œil montre un effet fortement négatif (β = –12,32, p = 0,0015) : plus l’œil est situé haut verticalement, plus la probabilité de comportement grégaire diminue. Ce résultat suggère qu’une position oculaire plus élevée serait associée à des espèces adoptant des stratégies d’alimentation ou de vigilance différentes, moins centrées sur le déplacement collectif. L’œil positionné plus haut peut être lié à des comportements plus benthiques ou plus solitaires, où la coordination avec des congénères est moins cruciale.

D’un point de vue biologique, ces deux traits capturent des principes importants en écologie fonctionnelle :

-   le rapport d’aspect reflète des capacités locomotrices adaptées aux déplacements groupés.

-   la position de l’œil reflète des contraintes sensorielles et comportementales influençant la nécessité d’un comportement social.

Le modèle présente une déviance résiduelle réduite par rapport à la déviance nulle et un AIC de 115,8, indiquant que l’ajout de ces deux prédicteurs améliore réellement la capacité du modèle à expliquer la présence du comportement de banc. La courbe ajustée montre une augmentation claire de la probabilité de banc lorsque le rapport d’aspect augmente, tandis que la position de l’œil module fortement ce lien.

Dans l’ensemble, ces résultats soutiennent l’idée qu’une partie importante du comportement social des poissons peut être prédite à partir de traits morphologiques clés, ce qui correspond directement à l’objectif initial du projet : comprendre comment la morphologie influence la tendance des poissons à former des bancs.

#### Modèle linéaire généralisé et/ou mixte 2

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

```{r essais glm2}
#Fish_glm2A <- glm(data = Fish_data, Comportement_banc_bin ~ Longueur_max, family = binomial())
#summary(Fish_glm2A)

#Fish_glm2B <- glm(data = Fish_data, Comportement_banc_bin ~ Longueur_max + Taille_nageoire_pectorale, family = binomial())
#summary(Fish_glm2B) 
```

Le premier modèle, basé uniquement sur la longueur maximale, présente une faible capacité explicative (AIC = 127,6) et ne montre qu’un effet marginalement significatif. Le second modèle améliore l’ajustement (AIC = 120,1) mais reste limité par la complexité croissante et la sensibilité des coefficients.

```{r glm2}
Fish_glm2 <- glm(data = Fish_data, Comportement_banc_bin ~ Longueur_max * Taille_nageoire_pectorale,
    family = binomial())
summary_(Fish_glm2) |> tabularise()
```

```{r graphique glm2}
chart(data = Fish_data, Comportement_banc_bin ~ Longueur_max %col=% Taille_nageoire_pectorale ) +
  geom_point(size = 3, alpha = 0.7) +
  scale_color_viridis_c() +
 geom_smooth(method = "glm", formula = y ~ x, se = TRUE, color = "magenta") +
  labs( x = "Longueur maximale (cm)",
    y = "Comportement de banc (0 = non, 1 = schooling)",
  title = "Comportement en banc en fonction de la longueur et de la taille de la nageoire pectorale")
```

Discussion: Le modèle montre que la longueur du poisson et la taille de sa nageoire pectorale influencent toutes les deux la probabilité qu’ils vivent en groupe. Plus un poisson est long, moins il a tendance à faire du schooling, et c’est la même chose quand sa nageoire pectorale est grande. Les deux variables interagissent aussi : l’effet de la longueur n’est pas le même selon la taille de la nageoire.

Le modèle s’ajuste bien aux données (pas de surdispersion), et tous les paramètres sont significatifs, donc les deux caractéristiques retenues expliquent réellement le comportement en groupe chez ces espèces.

#### Comparaison des modèles et choix des modèles finaux

Les six modèles testés explorent différentes relations entre traits morphologiques, écologiques et comportementaux chez les poissons. Les modèles linéaires simples (modèles 1 et 2) mettent en évidence des relations allométriques robustes entre la taille de l’œil et la longueur corporelle, mais restent limités par l’absence de variables écologiques ou comportementales. Le modèle 3, intégrant la position verticale dans la colonne d’eau et une transformation logarithmique de la longueur maximale, présente le meilleur compromis entre qualité d’ajustement (R² ajusté = 0.630), respect des hypothèses du modèle et pertinence biologique.

Les modèles 4 à 6 intègrent explicitement le comportement de banc. Parmi eux, le modèle linéaire 4 souffre d’un pouvoir explicatif plus faible et de résidus influencés par des valeurs extrêmes. Les modèles linéaires généralisés permettent une approche plus directe de la prédiction du comportement. Le modèle 6 se distingue par le meilleur AIC et par une interaction biologiquement cohérente entre la taille corporelle et la taille des nageoires pectorales, traduisant des stratégies de nage collective.

<<<<<<< HEAD
```{r}
# Comparaison AIC
AIC(Fish_glm1, Fish_glm2)

```

Les deux modèles linéaires généralisés analysent le comportement de banc à partir de variables morphologiques différentes et ne sont pas emboîtés, ce qui ne permet pas une comparaison par ANOVA. La comparaison a donc été réalisée à l’aide de l’AIC. Le modèle incluant le rapport d’aspect et la position verticale de l’œil(Fish_glm2) présente un AIC plus faible et des coefficients biologiquement cohérents, indiquant un meilleur compromis entre qualité d’ajustement et simplicité. Il est donc retenu comme le modèle le plus pertinent pour expliquer le comportement de banc.

En conséquence, deux modèles complémentaires ont été retenus : ...

=======
>>>>>>> 068337feabeb6dfcca6d5a2022fef857be47f2fc
## Conclusion

<!--% Lorsque toutes les analyses sont réalisées, terminez ce bloc-notes avec 3 à 6 phrases de conclusion en rapport avec ce que vous avez observé dans vos analyses. Quels sont les modèles les plus pertinents que vous retenez ? -->

Dans l’ensemble, nos analyses montrent que plusieurs traits morphologiques clés influencent à la fois la performance locomotrice et certains comportements sociaux chez les poissons des Grands Lacs. Les relations exploratoires soulignent notamment l’importance du rapport d’aspect et de l’étroitesse du pédoncule caudal, fortement associés aux espèces formant des bancs et à des stratégies de nage rapides et efficaces. Les modèles linéaires confirment également que la taille relative de l’œil diminue avec l’augmentation de la taille corporelle.

Parmi les modèles testés, les régressions intégrant des interactions biologiquement pertinentes (par exemple, l’effet différent du rapport d’aspect selon la position verticale) se révèlent plus informatives que les modèles simples, tout en restant suffisamment parcimonieuses. Enfin, le modèle logistique identifie deux prédicteurs robustes du comportement de banc le rapport d’aspect et la position verticale de l’œil indiquant que ces traits morphologiques jouent un rôle majeur dans la structuration des comportements sociaux.

Les modèles retenus comme les plus pertinents sont donc : la régression polynomiale reliant la taille de l’œil à la longueur maximale, le modèle linéaire avec interaction Rapport_aspect × Vertical_station, et le GLM logistique expliquant le comportement de banc, car ils offrent les résultats les plus cohérents et biologiquement interprétables.

## Références

<!--% N'indiquez rien ci-dessous. Quarto se chargera de rajouter vos références bibliographiques automatiquement. -->
