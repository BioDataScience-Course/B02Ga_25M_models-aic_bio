---
title: "Relations morphologie-comportement chez les poissons des Grands Lacs : (à completer)"
author: "Amal Abarou, Ide Tchuileng, Christelle Baseka"
format:
  html:
    code-fold: true
    code-tools: true
    toc: true
editor: visual
lang: fr
bibliography: references.bib
---

<!--# Ceci est un commentaire. -->

<!--% Ceci est une consigne. Ne jamais modifier ni déplacer les consignes dans le document ! -->

<!--% Complétez le titre et le nom des auteurs (auteur1, auteur2, auteur3 et auteur 4) dans l'entête YAML.-->

## Introduction et but

<!--% Rédigez une courte introduction de 3 ou 5 phrases qui présente vos données. Ajoutez une phrase de but (que vous remanierez éventuellement en fonction des modèles que vous ajouterez plus tard). Vous pouvez citer la bibliographie en utilisant le formatage Markdown ad hoc et en incluant votre référence au format bibtex dans le fichier references.bib. -->

... Introduction et but...

Les poissons des Grands Lacs présentent une grande diversité de morphologies et de comportements, qui influencent leur capacité à se déplacer dans leur environnement et à franchir des obstacles tels que barrages, passes à poissons ou variations de débit. L’ensemble de ces caractéristiques peut conditionner leur performance de nage et donc leurs chances de migration et de survie.

Dans ce travail, nous utilisons les données du *FishPass Sortable Attribute Database* (Benoit *et al.*, 2023) qui regroupent des traits morphologiques (par ex. longueur maximale, forme du corps, taille et position des nageoires) ainsi que des traits comportementaux (position verticale dans la colonne d'eau, comportement de banc).

**But** :\

## Matériel et méthodes

<!--% Indiquez ici d'où viennent les données et aussi quel logiciel (et version) vous utilisez pour les analyses. Inspirez-vous des projets du premier module de SDD II. -->

...Matériel et méthodes...

Les données utilisées proviennent de la base FishPass Morphology et de la base FishPass Behaviour compilées par Benoit et al. (2023, DOI: <https://doi.org/10.5061/dryad.fqz612jwj>). Les deux bases ont été fusionnées par espèce (Order, Family, Genus, Scientific.Name, Common.Name), ce qui a permis d’obtenir un jeu unique intégrant à la fois des mesures morphologiques et des informations comportementales pour chaque espèce. Pour ce projet, seules les variables morphologiques et comportementales les plus pertinentes ont été retenues : longueur maximale, profondeur du corps, rapport d’aspect, étroitesse du pédoncule caudal, position et taille des nageoires pectorales, position verticale et taille de l’œil, forme du corps et comportement de banc.

Les données ont été nettoyées et harmonisées : renommage des colonnes, conversion des variables numériques, suppression des lignes avec valeurs manquantes et ajout de labels et unités. Afin d’assurer une représentativité statistique suffisante, seuls les ordres présentant un effectif ≥ 10 individus ont été conservés. Les ordres retenus pour les analyses sont *Cypriniformes, Perciformes et Salmoniformes.* Les autres ordres, comportant trop peu d’observations, ont été exclus pour garantir la robustesse des résultats.

Les analyses sont réalisées dans `r R.version.string` avec le package `{tidyverse}` version `r packageVersion("tidyverse")` et `{tabularise}` version `r packageVersion("tabularise")` pour le traitement et la visualisation des données, et `{labelled}` version `r packageVersion("labelled")` pour les labels et unités. Le seuil de significativité α est fixé à 5 %.

## Analyses

```{r setup, include=FALSE}
# Ceci est nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))

# Configure Knitr to use AGG as graphic device
knitr::opts_chunk$set(dev = "ragg_png")

# Configuration de l'environnement
SciViews::R("model","infer", lang = "fr")
```

<!--% Importez les données que vous aurez préalablement nettoyées, remaniées et labélisées dans le script R nommé `R/import.R`. -->

```{r import}
# Lecture des données
Fish_data <- read.csv("data/Fish_data.csv", header = TRUE, sep = ",")
# Tableau des premières et dernières lignes
tabularise$headtail(Fish_data)
```

### Description des données

<!--% Chaque étudiant réalise et interprète un graphique pertinent en lien avec le but fixé et les modèles qui seront réalisés. Graphique et interprétation de l'étudiant #1 ci-dessous. -->

```{r chart1 }

# Relation entre rapport d’aspect et étroitesse du pédoncule caudal
chart(data = Fish_data,
      Etroitesse_pedoncule ~ Rapport_aspect %col=% Comportement_banc | Ordre) +
  geom_point(size = 3, alpha = 0.8) +
  labs(
    x = "Rapport d’aspect de la nageoire caudale",
    y = "Étroitesse du pédoncule caudal",
    title = "Relation entre la morphologie caudale et le comportement de banc",
    subtitle = "Comparaison du rapport d’aspect et de l’étroitesse du pédoncule caudal selon l’ordre"
  )
```

Le graphique illustre la relation entre le rapport d’aspect de la nageoire caudale et l’étroitesse du pédoncule caudal chez trois ordres de poissons (Cypriniformes, Perciformes et Salmoniformes), en distinguant les espèces grégaires (schooling) des espèces solitaires (non-schooling).

Globalement, on observe que les espèces grégaires(schooling) tendent à présenter des valeurs de rapport d’aspect plus élevées et un pédoncule caudal plus étroit que les espèces solitaires. Cette combinaison morphologique est typique d’une nage rapide, efficace et soutenue, adaptée aux déplacements collectifs dans la colonne d’eau. Elle favorise la réduction de la traînée hydrodynamique et une meilleure endurance, caractéristiques essentielles pour maintenir la cohésion d’un banc en mouvement.

Chez les Cypriniformes, cette tendance apparaît particulièrement nette : les espèces grégaires se concentrent dans une zone du graphique où le pédoncule est plus fin et le rapport d’aspect plus élevé.\
Chez les Perciformes, la dispersion est plus grande, ce qui suggère une diversité morphologique plus importante au sein du groupe, reflétant des stratégies de nage variées selon les espèces.\
Les Salmoniformes montrent un profil plus homogène, avec des morphologies globalement adaptées à la nage en pleine eau, indépendamment du comportement social, ce qui peut s’expliquer par leurs contraintes migratoires et leur mode de déplacement particulier.

Ce graphique met en évidence que les espèces présentant une morphologie caudale optimisée pour la vitesse et l’endurance c’est-à-dire un pédoncule étroit et un rapport d’aspect élevé sont majoritairement associées à un comportement grégaire. Ces résultats soutiennent l’hypothèse selon laquelle la morphologie influence la stratégie de déplacement, en particulier la capacité à se déplacer collectivement.

<!--% Graphique et interprétation de l'étudiant #2 ci-dessous. -->

```{r chart2}
chart(data = Fish_data, Profondeur_corps ~ Taille_oeil %col=% Vertical_station | Ordre) +
  geom_point(size = 3) +
  labs(
    x = "Profondeur moyenne de vie (m)",
    y = "Taille de l’œil (mm)",
    title = "Influence de la profondeur sur la taille de l’œil selon l'ordre"
  )

```

... interprétation #2...

Cypriniformes :

Les tailles des yeux sont plutôt dispersées entre \~15 et 35 mm.

Les benthopélagiques (rose) semblent légèrement plus nombreux à avoir des yeux grands ou moyens.

Il n’y a pas de tendance très claire avec la profondeur.

Les démersaux (vert) ont des yeux dans une gamme similaire, sans réelle distinction.

Perciformes :

Ici, on voit une tendance plus nette : certains individus benthopélagiques ont des yeux très grands (\~40 mm) à des profondeurs moyennes autour de 20-25 m.

Les démersaux (vert) ont tendance à avoir des yeux plus petits que les benthopélagiques à des profondeurs similaires.

Peu de pélagiques (bleu), mais ils ont de petits yeux (\~18 mm) à profondeur faible (\~18 m).

Salmoniformes :

Les tailles des yeux sont globalement plus petites (15-27 mm) et la variation avec la profondeur est faible.

Les benthopélagiques ont des yeux légèrement plus grands que les démersaux et pélagiques.

De facon generale:

Les poissons benthopélagiques semblent parfois avoir des yeux plus grands, surtout chez les Perciformes. Et donc vivent souvent près du fond ou dans des zones plus sombres, peuvent avoir développé des yeux plus grands pour mieux capter la lumière.

Les pélagiques ou démersaux n’ont pas cette pression et donc des yeux plus petits suffisent.

<!--% Graphique et interprétation de l'étudiant #3 ci-dessous. -->

```{r chart3 }

chart(data = Fish_data,
      Taille_nageoire_pectorale ~ Comportement_banc %fill=% Forme_corps) +
  geom_boxplot(alpha = 1, width = 0.6, position = position_dodge(0.8)) +
  labs(
    x = "Comportement de banc",
    y = "Taille de la nageoire pectorale (mm)",
    title = "Taille des nageoires pectorales selon le comportement et la forme du corps"
  ) 
```

... interprétation #3...

#### Effet du comportement de banc

-   Les poissons non-schooling présentent des nageoires pectorales plus grandes en moyenne que ceux en schooling, surtout pour la forme *short/deep*.

-   En schooling, la taille des nageoires est plus homogène et réduite, ce qui peut indiquer une adaptation à la nage collective où la manœuvrabilité individuelle est moins cruciale.

    #### Effet de la forme du corps

    -   Short/deep : Ce groupe a les nageoires les plus grandes, particulièrement chez les individus non-schooling (médiane ≈ 0,26 mm). Cela suggère que les poissons à corps court et profond ont besoin de nageoires plus développées pour compenser leur morphologie et assurer la stabilité.

    -   Elongated : Taille intermédiaire, mais avec une forte variabilité chez les non-schooling (médiane ≈ 0,18 mm, mais étendue large). Cela pourrait refléter des stratégies variées selon l’habitat ou le comportement.

    -   Fusiform : Les nageoires sont les plus petites et les plus constantes (≈ 0,17 mm), ce qui est cohérent avec une forme hydrodynamique favorisant la nage rapide sans nécessiter de grandes nageoires.

### Modélisation

Voici la corrélation de Pearson observée entre les variables quantitatives :

<!--% Création ci-dessous du tableau des corrélations de Pearson entre les variables quantitatives en passant par un objet correlation. -->

Pour explorer les relations potentielles entre les différentes caractéristiques morphologiques des poissons étudiés, nous avons réalisé une analyse de corrélation de Pearson. Cette méthode permet d’évaluer la force et le sens de l’association linéaire entre deux variables quantitatives.

```{r corr, record='ROA', object='corr', arg='dimnames', warning=FALSE}
(Fish_data_corr <- correlation(sselect(Fish_data,Longueur_max, Profondeur_corps, Rapport_aspect, Etroitesse_pedoncule, Position_nageoire_pectorale, Taille_nageoire_pectorale, Position_oeil_vertical, Taille_oeil))) |>
  tabularise()
plot(Fish_data_corr, type = "lower")

```

<!-- Commentez la table des corrélations. -->

La plupart des corrélations entre caractères sont faibles à modérées. Le rapport d’aspect et l’étroitesse du pédoncule caudal montrent une corrélation positive notable (r = 0,38), suggérant une adaptation à la nage rapide. La longueur maximale est fortement négativement corrélée avec la taille de l’œil (r = -0,69), tandis que la profondeur du corps est modérément liée à la taille des nageoires pectorales (r = 0,45).

<!--% Chaque modèle doit être décrit à l'aide d'un graphique et d'un tableau résumant le modèle. Les équations paramétrées de tous les modèles doivent être également présentes. L'analyse des résidus sera réalisée et interprétée pour chaque modèle. -->

#### Régression linéaire 1

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

```{r}
# Modèle de régression linéaire polynomial

#Poly1_lm <- lm(data = Fish_data, Longueur_max ~ Taille_oeil)

Poly1_lm <- lm(data = Fish_data, Longueur_max ~ Taille_oeil + I(Taille_oeil^2))
summary_(Poly1_lm) |> tabularise()

```

-Tous les coefficients sont statistiquement significatifs (p-value \< au seuil), ce qui signifie que la taille de l’œil et son carré ont un effet significatif sur la longueur maximale. -Étendue des résidus : \[-95.43, 105.6\], les résidus sont très larges par rapport aux valeurs prédites, ce qui suggère des erreurs importantes pour certaines observations. -Le modèle dans son ensemble est significatif (p-value de Statistique F \< au seuil alpha) et explique un peu plus de la moitié de la variation de la longueur maximale(R\^2 ajusté 54%), ce qui est correct mais laisse encore beaucoup de variabilité non expliquée.

```{r}
# Visualisation du modèle
chart(Poly1_lm)
```

```{r}
# Analyse des résidus
chart$residuals(Poly1_lm)
```

-   la distribition des residus est très élevé par rapports aux valeurs predites (A)
-   Les points suivent globalement la ligne,sauf pour les grandes valeurs qui s'écartent, donc la normalité est raisonnable.(B)
-   La tendance ascendante montre que la variance augmente avec la valeur prédite il y a hétéroscédasticité modérée.(C) -Présence des points influents avec une grande distance de cook et un effet de levier.

#### Régression linéaire 2

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

<<<<<<< HEAD
Discussion: Amal \#### Modèle linéaire 1

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r}
=======
```{r}
Fish_poly2 <- lm(data= Fish_data, log(Longueur_max) ~ Taille_oeil + I(Taille_oeil^2))
summary_(Fish_poly2) |> tabularise()

```

```{r}
#Visualisation du modele
chart(data = Fish_data, log(Longueur_max) ~ Taille_oeil) +
  geom_point() +
  geom_smooth(
    method = "lm",
    formula = y ~ x + I(x^2),
    se = TRUE,
    color = "blue"
  ) +
  labs(
    title = "Visualisation du modèle polynomial (log-transformé)",
    x = "Taille de l'œil",
    y = "log(Longueur_max)"
  )


```

```{r}
#Analyse des residus
chart$residuals(Fish_poly2)
```

Discussion: Amal

Modèle linéaire 1

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

Examiner l’effet combiné de plusieurs traits morphologiques et comportementaux sur la longueur maximale.

```{r record='RNCS'}
>>>>>>> c37275f0657580a6c83ada4831f6efab884bb297
chart(data = Fish_data, Longueur_max ~ Profondeur_corps %col=% Comportement_banc) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = TRUE) +
  labs(title = "Interaction Profondeur_corps et Comportement_banc",
       x = "Profondeur du corps",
       y = "Longueur max (cm)")
```

<<<<<<< HEAD
```{r}
=======
```{r record='RNCS'}
>>>>>>> c37275f0657580a6c83ada4831f6efab884bb297
chart(data = Fish_data, Longueur_max ~ Rapport_aspect %col=% Vertical_station) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = TRUE) +
  labs(title = "Interaction Vertical_station et Rapport_aspect",
       x = "Rapport d'aspect",
       y = "Longueur max")
```

```{r record='RODFS'}
#Fish_lm <- lm(data = Fish_data, Longueur_max ~ Taille_oeil + Profondeur_corps + Vertical_station + Profondeur_corps * Comportement_banc + Vertical_station * Rapport_aspect) 
#summary(Fish_lm) |> tabularise()

Fish_lm1 <- lm(data = Fish_data,
               subset = Vertical_station %in% c("pelagic", "benthopelagic"), 
Longueur_max ~ Taille_oeil + Profondeur_corps + Vertical_station + Profondeur_corps * Comportement_banc + Vertical_station * Rapport_aspect)
summary_(Fish_lm1) |> tabularise()

```

```{r analyse residus}
chart$residuals(Fish_lm1)
```

<<<<<<< HEAD
Discussion: Ide \#### Modèle linéaire 2
=======
Discussion: Ide

Modèle linéaire 2
>>>>>>> c37275f0657580a6c83ada4831f6efab884bb297

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r}

Fish_lm2 <- lm(data = Fish_data, Taille_oeil ~ Longueur_max  * Comportement_banc )
summary_(Fish_lm2) |> tabularise()
```

-le pvalue de Fstatistique est inférieur au seuil, le modèle est significatif dans son ensemble. -R²ajusté = 0.4982 : le modèle explique environ 50% de la variation de la taille d’œil. -Toutes les variables sont significatives (p \< 0.05), donc l’interaction est pertinente. -Les résidus sont raisonnables (étendue \[-13.56, 13.35\]), suggérant que le modèle est bien ajusté. -La taille d’œil est influencée par la longueur du poisson et par le comportement de banc. L’interaction montre que l’effet de la taille du poisson sur l’œil dépend du comportement de banc : schooling et non-schooling.

```{r}
chart(data = Fish_data, Taille_oeil ~ Longueur_max   %col=% Comportement_banc) +
  geom_point() +
  stat_smooth(method = "lm", formula = y ~ x)
```

-Les poissons non-schooling ont une relation plus linéaire et moins raide. -Les poissons schooling montrent une pente plus prononcée, confirmant l’interaction trouvée dans le modèle (β3).

```{r}
# Analyse des résidus
chart$residuals(Fish_lm2)
```

-   L'etendue des residus est elevée par rapport aux valeurs prédites
<<<<<<< HEAD
-   Les résidus suivent à peu près une distribution normale
-   Il n' y a pas de tendance forte, homoscédasticité
-   Il y a présence d'observations influentes par leur distance de cook
-   Une observation a un effet de levier important avec une distance de cook influente \#### Modèle linéaire généralisé et/ou mixte 1

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

Discussion: Amal \#### Modèle linéaire généralisé et/ou mixte 2

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

Discusson: Ide \## Conclusion
=======

-   Les résidus suivent à peu près une distribution normale

-   Il n' y a pas de tendance forte, homoscédasticité

-   Il y a présence d'observations influentes par leur distance de cook

-   Une observation a un effet de levier important avec une distance de cook influente

    \#### Modèle linéaire généralisé et/ou mixte 1

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

Discussion: Amal

\#### Modèle linéaire généralisé et/ou mixte 2

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

```{r}
Fish_data$Comportement_banc_num <- ifelse(Fish_data$Comportement_banc == "schooling", 1, 0)

Fish_glm2 <- glm(data = Fish_data, Comportement_banc_num ~ Longueur_max * Taille_nageoire_pectorale,
    family = binomial())
summary_(Fish_glm2) |> tabularise()

#Fish_data$Prob_predite <- predict(Fish_glm2, type = "response")
chart(data = Fish_data,
      Comportement_banc_num ~ Longueur_max %col=% Taille_nageoire_pectorale ) +
  geom_point(size = 2, alpha = 0.7) +
  scale_color_viridis_c() +
 geom_smooth(method = "glm", formula = y ~ x, se = TRUE, color = "magenta") +
  labs(
    x = "Longueur maximale (cm)",
    y = "Comportement de banc (0 = non, 1 = schooling)",
    title = "Probabilité prédite du comportement en banc en fonction de la longueur et de la taille de la nageoire pectorale"
  )

```

Discussion: Ide

\## Conclusion
>>>>>>> c37275f0657580a6c83ada4831f6efab884bb297

<!--% Lorsque toutes les analyses sont réalisées, terminez ce bloc-notes avec 3 à 6 phrases de conclusion en rapport avec ce que vous avez observé dans vos analyses. Quels sont les modèles les plus pertinents que vous retenez ? -->

...vos conclusions ici...

## Références

<!--% N'indiquez rien ci-dessous. Quarto se chargera de rajouter vos références bibliographiques automatiquement. -->
